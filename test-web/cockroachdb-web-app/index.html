<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CockroachDB Web App</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
      }
      h1 {
        color: #333;
      }
      a {
        display: block;
        margin: 10px 0;
        color: #007bff;
        text-decoration: none;
      }
      a:hover {
        text-decoration: underline;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
      }
      th,
      td {
        padding: 10px;
        border: 1px solid #ddd;
        text-align: left;
      }
      th {
        background-color: #f4f4f4;
      }
    </style>
  </head>
  <body>
    <h1>CockroachDB Tables</h1>
    <div id="table-links">
    </div>

    <h2>Table Data</h2>
    <table id="data-table">
      <thead>
        <tr>
        </tr>
      </thead>
      <tbody>
      </tbody>
    </table>

    <script>
      const tables = [
        "Conversation",
        "Channel",
        "Private_Chat",
        "Public_Conversation",
        "Shared_Media",
        "User_Conversations",
        "Booster",
        "Has_PV",
        "Ban",
        "Advertisement",
        "Invite_Link",
        "Group",
        "Member_Of",
        "Admin",
        "Subscribed_To",
        "Users",
        "Human_user",
        "Contact",
        "Phantom",
        "Private_Prof",
        "Block_user",
        "Host",
        "Bot_Commands",
        "Story",
        "Send_Slicker",
        "Has_Slicker_Pack",
        "Session",
        "Message",
        "Payment",
        "Name",
        "Sticker_Pack",
        "Message_Sticker",
        "Post_Message",
        "Vote",
        "Post_Option",
        "Card",
        "Call",
        "Sticker",
        "Reacts",
        "Media",
      ];

      function createTableLinks() {
        const tableLinksDiv = document.getElementById("table-links");
        tables.forEach((table) => {
          const link = document.createElement("a");
          link.href = "#";
          link.textContent = table;
          link.addEventListener("click", () => fetchTableData(table));
          tableLinksDiv.appendChild(link);
        });
      }

      async function fetchTableData(tableName) {
  try {
    const response = await fetch(`http://localhost:3000/table/${tableName}`);

    if (!response.ok) {
      throw new Error(`HTTP error! Status: ${response.status}`);
    }

    const data = await response.json();

    const table = document.getElementById("data-table");
    table.innerHTML = "";

    if (data.length > 0) {
      const headers = Object.keys(data[0]);
      const headerRow = document.createElement("tr");
      headers.forEach((header) => {
        const th = document.createElement("th");
        th.textContent = header;
        headerRow.appendChild(th);
      });
      table.appendChild(headerRow);

      data.forEach((row) => {
        const tr = document.createElement("tr");
        headers.forEach((header) => {
          const td = document.createElement("td");
          td.textContent = row[header];
          tr.appendChild(td);
        });
        table.appendChild(tr);
      });
    } else {
      table.innerHTML = "<tr><td>No data found</td></tr>";
    }
  } catch (error) {
    console.error("Error fetching table data:", error);
    alert(`Error fetching table data: ${error.message}`);
  }
}
      createTableLinks();
    </script>
  </body>
</html>